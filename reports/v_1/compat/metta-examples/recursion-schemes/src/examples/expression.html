<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>
<style type="text/css">
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi31 { color: #aa0000; }
.ansi32 { color: #00aa00; }
.ansi33 { color: #aa5500; }
.ansi38-000068000 { color: #004400; }
.ansi38-000068000 { color: #004400; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-000068000 { color: #004400; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-000068000 { color: #004400; }
.ansi38-000068000 { color: #004400; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-000068000 { color: #004400; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-000068000 { color: #004400; }
.ansi38-000068000 { color: #004400; }
</style>
</head>
<body class="body_foreground body_background" style="font-size: normal;" >
<pre class="ansi2html-content">
 (@ track_load_into_file "/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta")
%~ load_answer_file( '/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta.answers',
%~   '/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta')
1=[()]
2=[(evalExpr (mapExpr (cata mapExpr evalExpr) (unFix (Fix (Plus (Fix (Plus (Fix (Var X)) (Fix (Const 2)))) (Fix (Const 40)))))))]
3=[(Fix (Plus (Fix (Const 2)) (Fix (Const 2))))]
4=[9]
5=[(diff (mapExpr (para_pair mapExpr diff) (unFix (Fix (Plus (Fix (Var X)) (Fix (Const 1)))))))]
6=[(Fix $Y), (2t $x#534), (1p $x#535)]
7=[(Fix (Plus (Fix (Plus (Fix (Const 1)) (Fix (Var X)))) (Fix (Plus (Fix (Const 1)) (Fix (Var X))))))]
8=1.20user 0.00system 0:01.21elapsed 100%CPU (0avgtext+0avgdata 34056maxresident)k
8=0inputs+0outputs (0major+3707minor)pagefaults 0swaps
:- dynamic file_answers/3.

file_answers('/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta', 1, [[]]).
file_answers('/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta', 2, [[evalExpr, [mapExpr, [cata, mapExpr, evalExpr], [unFix, ['Fix', ['Plus', ['Fix', ['Plus', ['Fix', ['Var', 'X']], ['Fix', ['Const', 2]]]], ['Fix', ['Const', 40]]]]]]]]).
file_answers('/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta', 3, [['Fix', ['Plus', ['Fix', ['Const', 2]], ['Fix', ['Const', 2]]]]]).
file_answers('/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta', 4, [9]).
file_answers('/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta', 5, [[diff, [mapExpr, [para_pair, mapExpr, diff], [unFix, ['Fix', ['Plus', ['Fix', ['Var', 'X']], ['Fix', ['Const', 1]]]]]]]]).
file_answers('/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta', 6, [['Fix', Y], ',', [2, t, X_C35_534], ',', [1, p, X_C35_535]]).
file_answers('/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta', 7, [['Fix', ['Plus', ['Fix', ['Plus', ['Fix', ['Const', 1]], ['Fix', ['Var', 'X']]]], ['Fix', ['Plus', ['Fix', ['Const', 1]], ['Fix', ['Var', 'X']]]]]]]).

;; !(import! &self "../schemes.metta")
<span class="ansi38-000068000">!(import! &self "../schemes.metta")

</span>      -->(0,'&self',['import!','&self','../schemes.metta'],depth(1))
%~ load_answer_file( '/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta.answers',
%~   '/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta')
; How to apply a function to the slots, a Functor's map
;; For references see https://github.com/passy/awesome-recursion-schemes
;; For my typed Scala implementation see https://github.com/Adam-Vandervorst/RecursionSchemes
<span class="ansi38-000068000">!(transfer! "base.metta")

</span>      -->(1,'&self',['transfer!',"base.metta"],depth(1))
%~ base.metta:1 
%~ load_answer_file( '/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta.answers',
%~   '/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta')
; folds
;; Wrapping and unwrapping for the recursion
;; Fix F = F (Fix F)
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[unFix,['Fix',X]],X)
</span><span class="ansi38-255165000">  (= 
    (unFix 
      (Fix $X)) $X)
</span>

; identity function, useful in the combinators due to lack of
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[identity,X],X)
</span><span class="ansi38-255165000">  (= 
    (identity $X) $X)
</span>

      <--(1,retval('Empty'))
<span class="ansi33"> Empty

</span><span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[cata,False,Alg],A],[Alg,[False,[cata,False,Alg],[unFix,A]]])
</span><span class="ansi38-255165000">  (= 
    ( (cata $False $Alg) $A) 
    ($Alg 
      ($False 
        (cata $False $Alg) 
        (unFix $A))))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[para_pair,False,Alg],A],[',',[[para,False,Alg],A],A])
</span><span class="ansi38-255165000">  (= 
    ( (para_pair $False $Alg) $A) 
    (and 
      ( (para $False $Alg) $A) $A))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[para,False,Alg],A],[Alg,[False,[para_pair,False,Alg],[unFix,A]]])
</span><span class="ansi38-255165000">  (= 
    ( (para $False $Alg) $A) 
    ($Alg 
      ($False 
        (para_pair $False $Alg) 
        (unFix $A))))
</span>

; unfolds
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[ana,False,Coalg],S],['Fix',[False,[ana,False,Coalg],[Coalg,S]]])
</span><span class="ansi38-255165000">  (= 
    ( (ana $False $Coalg) $S) 
    (Fix 
      ($False 
        (ana $False $Coalg) 
        ($Coalg $S))))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[futu_picking,False,Coalg],['Pure',A]],[[futu,False,Coalg],A])
</span><span class="ansi38-255165000">  (= 
    ( (futu_picking $False $Coalg) 
      (Pure $A)) 
    ( (futu $False $Coalg) $A))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[futu_picking,False,Coalg],['Bind',False]],['Fix',[False,[futu_picking,False,Coalg],False]])
</span><span class="ansi38-255165000">  (= 
    ( (futu_picking $False $Coalg) 
      (Bind $False)) 
    (Fix 
      ($False 
        (futu_picking $False $Coalg) $False)))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[futu,False,Coalg],S],['Fix',[False,[futu_picking,False,Coalg],[Coalg,S]]])
</span><span class="ansi38-255165000">  (= 
    ( (futu $False $Coalg) $S) 
    (Fix 
      ($False 
        (futu_picking $False $Coalg) 
        ($Coalg $S))))
</span>

; combinations
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[[hylo,False,Alg,Coalg],S],[Alg,[False,[hylo,False,Alg,Coalg],[Coalg,S]]])
</span><span class="ansi38-255165000">  (= 
    ( (hylo $False $Alg $Coalg) $S) 
    ($Alg 
      ($False 
        (hylo $False $Alg $Coalg) 
        ($Coalg $S))))
</span>

      <--(0,retval('Empty'))
<span class="ansi33"> Empty

</span><span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[mapExpr,False,['Plus',X,Y]],['Plus',[False,X],[False,Y]])
</span><span class="ansi38-255165000">  (= 
    (mapExpr $False 
      (Plus $X $Y)) 
    (Plus 
      ($False $X) 
      ($False $Y)))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[mapExpr,False,['Const',X]],['Const',X])
</span><span class="ansi38-255165000">  (= 
    (mapExpr $False 
      (Const $X)) 
    (Const $X))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[mapExpr,False,['Var',X]],['Var',X])
</span><span class="ansi38-255165000">  (= 
    (mapExpr $False 
      (Var $X)) 
    (Var $X))
</span>

; How to evaluate the structure to some value, a single step, an algebra
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[evalExpr,['Plus',X,Y]],[+,X,Y])
</span><span class="ansi38-255165000">  (= 
    (evalExpr 
      (Plus $X $Y)) 
    (+ $X $Y))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[evalExpr,['Const',X]],X)
</span><span class="ansi38-255165000">  (= 
    (evalExpr 
      (Const $X)) $X)
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[evalExpr,['Var',X]],[valueOf,X])
</span><span class="ansi38-255165000">  (= 
    (evalExpr 
      (Var $X)) 
    (valueOf $X))
</span>

; Dictionary we can use during evaluation
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[valueOf,'X'],0)
</span><span class="ansi38-255165000">  (= 
    (valueOf X) 0)
</span>

; A fold, with the Functor and algebra, applied to the Fix tree
<span class="ansi38-000068000">!((cata mapExpr evalExpr) 
  (Fix 
    (Plus 
      (Fix 
        (Plus 
          (Fix 
            (Var X)) 
          (Fix 
            (Const 2)))) 
      (Fix 
        (Const 40)))))

</span>      -->(2,'&self',[[cata,mapExpr,evalExpr],['Fix',['Plus',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],['Fix',['Const',40]]]]],depth(1))
          -->(3,'&self',['Var','X'],depth(3))
        -->(4,'&self',[evalExpr,[mapExpr,[cata,mapExpr,evalExpr],[unFix,['Fix',['Plus',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],['Fix',['Const',40]]]]]]],depth(2))
            -->(5,'&self',[cata,mapExpr,evalExpr],depth(4))
            -->(6,'&self',[cata,mapExpr,evalExpr],depth(4))
            -->(7,'&self',['Var','X'],depth(4))
            -->(8,'&self',['Const',2],depth(4))
            -->(9,'&self',['Const',40],depth(4))
            -->(10,'&self',[mapExpr,[cata,mapExpr,evalExpr],[unFix,['Fix',['Plus',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],['Fix',['Const',40]]]]]],depth(4))
                -->(11,'&self',[cata,mapExpr,evalExpr],depth(6))
                -->(12,'&self',[cata,mapExpr,evalExpr],depth(6))
                -->(13,'&self',['Var','X'],depth(6))
                -->(14,'&self',['Const',2],depth(6))
                -->(15,'&self',['Const',40],depth(6))
                -->(16,'&self',[cata,mapExpr,evalExpr],depth(6))
                -->(17,'&self',[unFix,['Fix',['Plus',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],['Fix',['Const',40]]]]],depth(6))
                    -->(18,'&self',['Var','X'],depth(8))
                  -->(19,'&self',['Plus',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],['Fix',['Const',40]]],depth(7))
                      -->(20,'&self',['Var','X'],depth(9))
                      -->(21,'&self',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],depth(9))
                          -->(22,'&self',['Var','X'],depth(11))
                          -->(23,'&self',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]],depth(11))
                              -->(24,'&self',['Var','X'],depth(13))
                              -->(25,'&self',['Fix',['Var','X']],depth(13))
                                  -->(26,'&self',['Var','X'],depth(15))
                                  -->(27,'&self',['Var','X'],depth(15))
                                  -->(28,'&self',['Var','X'],depth(15))
                              -->(29,'&self',['Fix',['Const',2]],depth(13))
                                  -->(30,'&self',['Const',2],depth(15))
                                  -->(31,'&self',['Const',2],depth(15))
                                  -->(32,'&self',['Const',2],depth(15))
                              -->(33,'&self',['Fix',['Var','X']],depth(13))
                                  -->(34,'&self',['Var','X'],depth(15))
                                  -->(35,'&self',['Var','X'],depth(15))
                                  -->(36,'&self',['Var','X'],depth(15))
                              -->(37,'&self',['Fix',['Const',2]],depth(13))
                                  -->(38,'&self',['Const',2],depth(15))
                                  -->(39,'&self',['Const',2],depth(15))
                                  -->(40,'&self',['Const',2],depth(15))
                          -->(41,'&self',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]],depth(11))
                              -->(42,'&self',['Var','X'],depth(13))
                              -->(43,'&self',['Fix',['Var','X']],depth(13))
                                  -->(44,'&self',['Var','X'],depth(15))
                                  -->(45,'&self',['Var','X'],depth(15))
                                  -->(46,'&self',['Var','X'],depth(15))
                              -->(47,'&self',['Fix',['Const',2]],depth(13))
                                  -->(48,'&self',['Const',2],depth(15))
                                  -->(49,'&self',['Const',2],depth(15))
                                  -->(50,'&self',['Const',2],depth(15))
                              -->(51,'&self',['Fix',['Var','X']],depth(13))
                                  -->(52,'&self',['Var','X'],depth(15))
                                  -->(53,'&self',['Var','X'],depth(15))
                                  -->(54,'&self',['Var','X'],depth(15))
                              -->(55,'&self',['Fix',['Const',2]],depth(13))
                                  -->(56,'&self',['Const',2],depth(15))
                                  -->(57,'&self',['Const',2],depth(15))
                                  -->(58,'&self',['Const',2],depth(15))
                      -->(59,'&self',['Fix',['Const',40]],depth(9))
                          -->(60,'&self',['Const',40],depth(11))
                          -->(61,'&self',['Const',40],depth(11))
                          -->(62,'&self',['Const',40],depth(11))
                      -->(63,'&self',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],depth(9))
                          -->(64,'&self',['Var','X'],depth(11))
                          -->(65,'&self',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]],depth(11))
                              -->(66,'&self',['Var','X'],depth(13))
                              -->(67,'&self',['Fix',['Var','X']],depth(13))
                                  -->(68,'&self',['Var','X'],depth(15))
                                  -->(69,'&self',['Var','X'],depth(15))
                                  -->(70,'&self',['Var','X'],depth(15))
                              -->(71,'&self',['Fix',['Const',2]],depth(13))
                                  -->(72,'&self',['Const',2],depth(15))
                                  -->(73,'&self',['Const',2],depth(15))
                                  -->(74,'&self',['Const',2],depth(15))
                              -->(75,'&self',['Fix',['Var','X']],depth(13))
                                  -->(76,'&self',['Var','X'],depth(15))
                                  -->(77,'&self',['Var','X'],depth(15))
                                  -->(78,'&self',['Var','X'],depth(15))
                              -->(79,'&self',['Fix',['Const',2]],depth(13))
                                  -->(80,'&self',['Const',2],depth(15))
                                  -->(81,'&self',['Const',2],depth(15))
                                  -->(82,'&self',['Const',2],depth(15))
                          -->(83,'&self',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]],depth(11))
                              -->(84,'&self',['Var','X'],depth(13))
                              -->(85,'&self',['Fix',['Var','X']],depth(13))
                                  -->(86,'&self',['Var','X'],depth(15))
                                  -->(87,'&self',['Var','X'],depth(15))
                                  -->(88,'&self',['Var','X'],depth(15))
                              -->(89,'&self',['Fix',['Const',2]],depth(13))
                                  -->(90,'&self',['Const',2],depth(15))
                                  -->(91,'&self',['Const',2],depth(15))
                                  -->(92,'&self',['Const',2],depth(15))
                              -->(93,'&self',['Fix',['Var','X']],depth(13))
                                  -->(94,'&self',['Var','X'],depth(15))
                                  -->(95,'&self',['Var','X'],depth(15))
                                  -->(96,'&self',['Var','X'],depth(15))
                              -->(97,'&self',['Fix',['Const',2]],depth(13))
                                  -->(98,'&self',['Const',2],depth(15))
                                  -->(99,'&self',['Const',2],depth(15))
                                  -->(100,'&self',['Const',2],depth(15))
Switched off tracing. For a longer trace !(pragma! tracelen 101))<span class="ansi33">
 42

</span><span class="ansi31">
! (assertEqualToResult 
    ( (cata mapExpr evalExpr) 
      (Fix 
        (Plus 
          (Fix 
            (Plus 
              (Fix 
                (Var X)) 
              (Fix 
                (Const 2)))) 
          (Fix 
            (Const 40))))) 
    ( (Fix 
        (Plus 
          (Fix 
            (Const 2)) 
          (Fix 
            (Const 2))))))
(@ ! 
  (assertEqual 
    (42) 
    ( (Fix 
        (Plus 
          (Fix 
            (Const 2)) 
          (Fix 
            (Const 2)))))))
write_pass_fail_result("EXAMPLES.EXPRESSION.103",exec,[[cata,mapExpr,evalExpr],['Fix',['Plus',['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',2]]]],['Fix',['Const',40]]]]],'FAIL',[['Fix',['Plus',['Fix',['Const',2]],['Fix',['Const',2]]]]],[42])

</span>

--------------------------------------------------------------------------
; How to generate the structure based on some value, a single step, a co-algebra
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[nTimes,[',',X,['S',['S',N]]]],['Plus',[',',X,['S','Z']],[',',X,['S',N]]])
</span><span class="ansi38-255165000">  (= 
    (nTimes 
      (and $X 
        (S 
          (S $N)))) 
    (Plus 
      (and $X 
        (S Z)) 
      (and $X 
        (S $N))))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[nTimes,[',',X,['S','Z']]],['Const',X])
</span><span class="ansi38-255165000">  (= 
    (nTimes 
      (and $X 
        (S Z))) 
    (Const $X))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[nTimes,[',',_,'Z']],['Const',0])
</span><span class="ansi38-255165000">  (= 
    (nTimes 
      (and $_ Z)) 
    (Const 0))
</span>

; An unfold, with the Functor and co-algebra, applied to some seed value
<span class="ansi38-000068000">!((ana mapExpr nTimes) 
  (and 2 
    (S 
      (S Z))))

</span>      -->(0,'&self',[[ana,mapExpr,nTimes],[',',2,['S',['S','Z']]]],depth(1))
          -->(1,'&self',['S','Z'],depth(3))
        -->(2,'&self',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,[',',2,['S',['S','Z']]]]]],depth(2))
            -->(3,'&self',[ana,mapExpr,nTimes],depth(4))
            -->(4,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,[',',2,['S',['S','Z']]]]],depth(4))
                -->(5,'&self',[ana,mapExpr,nTimes],depth(6))
                -->(6,'&self',[ana,mapExpr,nTimes],depth(6))
                -->(7,'&self',['S','Z'],depth(6))
                -->(8,'&self',[ana,mapExpr,nTimes],depth(6))
                -->(9,'&self',[nTimes,[',',2,['S',['S','Z']]]],depth(6))
                    -->(10,'&self',['S','Z'],depth(8))
                  -->(11,'&self',['Plus',[',',2,['S','Z']],[',',2,['S','Z']]],depth(7))
                      -->(12,'&self',['S','Z'],depth(9))
                      -->(13,'&self',[',',2,['S','Z']],depth(9))
                          -->(14,'&self',['S','Z'],depth(11))
                      <--(13,retval('True'))
                      -->(15,'&self',[',',2,['S','Z']],depth(9))
                          -->(16,'&self',['S','Z'],depth(11))
                      <--(15,retval('True'))
                      -->(17,'&self',[',',2,['S','Z']],depth(9))
                          -->(18,'&self',['S','Z'],depth(11))
                      <--(17,retval('True'))
                      -->(19,'&self',[',',2,['S','Z']],depth(9))
                          -->(20,'&self',['S','Z'],depth(11))
                      <--(19,retval('True'))
                  <--(11,retval(['Plus','True','True']))
                    -->(21,'&self',['Plus','True','True'],depth(8))
              -->(22,'&self',[mapExpr,[ana,mapExpr,nTimes],['Plus','True','True']],depth(5))
                  -->(23,'&self',[ana,mapExpr,nTimes],depth(7))
                -->(24,'&self',['Plus',[[ana,mapExpr,nTimes],'True'],[[ana,mapExpr,nTimes],'True']],depth(6))
                    -->(25,'&self',[ana,mapExpr,nTimes],depth(8))
                    -->(26,'&self',[[ana,mapExpr,nTimes],'True'],depth(8))
                      -->(27,'&self',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(28,'&self',[ana,mapExpr,nTimes],depth(11))
                          -->(29,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(30,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(31,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(32,'&self',[nTimes,'True'],depth(13))
                              -->(33,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(34,'&self',[nTimes,'True'],depth(13))
                          -->(35,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(36,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(37,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(38,'&self',[nTimes,'True'],depth(13))
                              -->(39,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(40,'&self',[nTimes,'True'],depth(13))
                    -->(41,'&self',[[ana,mapExpr,nTimes],'True'],depth(8))
                      -->(42,'&self',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(43,'&self',[ana,mapExpr,nTimes],depth(11))
                          -->(44,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(45,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(46,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(47,'&self',[nTimes,'True'],depth(13))
                              -->(48,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(49,'&self',[nTimes,'True'],depth(13))
                          -->(50,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(51,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(52,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(53,'&self',[nTimes,'True'],depth(13))
                              -->(54,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(55,'&self',[nTimes,'True'],depth(13))
                    <--(41,retval(['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]]))
                    <--(26,retval(['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]]))
                    -->(56,'&self',[[ana,mapExpr,nTimes],'True'],depth(8))
                      -->(57,'&self',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(58,'&self',[ana,mapExpr,nTimes],depth(11))
                          -->(59,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(60,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(61,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(62,'&self',[nTimes,'True'],depth(13))
                              -->(63,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(64,'&self',[nTimes,'True'],depth(13))
                          -->(65,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(66,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(67,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(68,'&self',[nTimes,'True'],depth(13))
                              -->(69,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(70,'&self',[nTimes,'True'],depth(13))
                    -->(71,'&self',[[ana,mapExpr,nTimes],'True'],depth(8))
                      -->(72,'&self',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(73,'&self',[ana,mapExpr,nTimes],depth(11))
                          -->(74,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(75,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(76,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(77,'&self',[nTimes,'True'],depth(13))
                              -->(78,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(79,'&self',[nTimes,'True'],depth(13))
                          -->(80,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(81,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(82,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(83,'&self',[nTimes,'True'],depth(13))
                              -->(84,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(85,'&self',[nTimes,'True'],depth(13))
                  -->(86,'&self',['Plus',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]],['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]]],depth(7))
                      -->(87,'&self',[ana,mapExpr,nTimes],depth(9))
                      -->(88,'&self',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(89,'&self',[ana,mapExpr,nTimes],depth(11))
                          -->(90,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(91,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(92,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(93,'&self',[nTimes,'True'],depth(13))
                              -->(94,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(95,'&self',[nTimes,'True'],depth(13))
                          -->(96,'&self',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(97,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(98,'&self',[ana,mapExpr,nTimes],depth(13))
                              -->(99,'&self',[nTimes,'True'],depth(13))
                              -->(100,'&self',[ana,mapExpr,nTimes],depth(13))
Switched off tracing. For a longer trace !(pragma! tracelen 101))<span class="ansi33">
  (Fix 
    (Plus 
      (Fix 
        (mapExpr 
          (ana mapExpr nTimes) 
          (nTimes True))) 
      (Fix 
        (mapExpr 
          (ana mapExpr nTimes) 
          (nTimes True)))))

</span><span class="ansi31">
! (assertEqualToResult 
    ( (ana mapExpr nTimes) 
      (and 2 
        (S 
          (S Z)))) 
    (9))
(@ ! 
  (assertEqual 
    ( (Fix 
        (Plus 
          (Fix 
            (mapExpr 
              (ana mapExpr nTimes) 
              (nTimes True))) 
          (Fix 
            (mapExpr 
              (ana mapExpr nTimes) 
              (nTimes True)))))) 
    (9)))
write_pass_fail_result("EXAMPLES.EXPRESSION.104",exec,[[ana,mapExpr,nTimes],[',',2,['S',['S','Z']]]],'FAIL',[9],[['Fix',['Plus',['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]],['Fix',[mapExpr,[ana,mapExpr,nTimes],[nTimes,'True']]]]]])

</span>

--------------------------------------------------------------------------
; Combining both into a "re-fold", starting with a (co-algebra) seed value, ending with a (algebra) result value
<span class="ansi38-000068000">!((hylo mapExpr evalExpr nTimes) 
  (and 3 
    (S 
      (S 
        (S Z)))))

</span>      -->(0,'&self',[[hylo,mapExpr,evalExpr,nTimes],[',',3,['S',['S',['S','Z']]]]],depth(1))
          -->(1,'&self',['S','Z'],depth(3))
        -->(2,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,[',',3,['S',['S',['S','Z']]]]]]],depth(2))
            -->(3,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(4))
            -->(4,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(4))
            -->(5,'&self',['S','Z'],depth(4))
            -->(6,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,[',',3,['S',['S',['S','Z']]]]]],depth(4))
                -->(7,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(6))
                -->(8,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(6))
                -->(9,'&self',['S','Z'],depth(6))
                -->(10,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(6))
                -->(11,'&self',[nTimes,[',',3,['S',['S',['S','Z']]]]],depth(6))
                    -->(12,'&self',['S','Z'],depth(8))
                  -->(13,'&self',['Plus',[',',3,['S','Z']],[',',3,['S',['S','Z']]]],depth(7))
                      -->(14,'&self',['S','Z'],depth(9))
                      -->(15,'&self',[',',3,['S','Z']],depth(9))
                          -->(16,'&self',['S','Z'],depth(11))
                      <--(15,retval('True'))
                      -->(17,'&self',[',',3,['S',['S','Z']]],depth(9))
                          -->(18,'&self',['S',['S','Z']],depth(11))
                              -->(19,'&self',['S','Z'],depth(13))
                              -->(20,'&self',['S','Z'],depth(13))
                              -->(21,'&self',['S','Z'],depth(13))
                      <--(17,retval('True'))
                      -->(22,'&self',[',',3,['S','Z']],depth(9))
                          -->(23,'&self',['S','Z'],depth(11))
                      <--(22,retval('True'))
                      -->(24,'&self',[',',3,['S',['S','Z']]],depth(9))
                          -->(25,'&self',['S',['S','Z']],depth(11))
                              -->(26,'&self',['S','Z'],depth(13))
                              -->(27,'&self',['S','Z'],depth(13))
                              -->(28,'&self',['S','Z'],depth(13))
                      <--(24,retval('True'))
                  <--(13,retval(['Plus','True','True']))
                    -->(29,'&self',['Plus','True','True'],depth(8))
              -->(30,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],['Plus','True','True']],depth(5))
                  -->(31,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(7))
                -->(32,'&self',['Plus',[[hylo,mapExpr,evalExpr,nTimes],'True'],[[hylo,mapExpr,evalExpr,nTimes],'True']],depth(6))
                    -->(33,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(8))
                    -->(34,'&self',[[hylo,mapExpr,evalExpr,nTimes],'True'],depth(8))
                      -->(35,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(36,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(37,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(38,'&self',[nTimes,'True'],depth(11))
                          -->(39,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(40,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(41,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(42,'&self',[nTimes,'True'],depth(13))
                              -->(43,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(44,'&self',[nTimes,'True'],depth(13))
                    -->(45,'&self',[[hylo,mapExpr,evalExpr,nTimes],'True'],depth(8))
                      -->(46,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(47,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(48,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(49,'&self',[nTimes,'True'],depth(11))
                          -->(50,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(51,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(52,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(53,'&self',[nTimes,'True'],depth(13))
                              -->(54,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(55,'&self',[nTimes,'True'],depth(13))
                    <--(45,retval([evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]]))
                    <--(34,retval([evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]]))
                    -->(56,'&self',[[hylo,mapExpr,evalExpr,nTimes],'True'],depth(8))
                      -->(57,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(58,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(59,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(60,'&self',[nTimes,'True'],depth(11))
                          -->(61,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(62,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(63,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(64,'&self',[nTimes,'True'],depth(13))
                              -->(65,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(66,'&self',[nTimes,'True'],depth(13))
                    -->(67,'&self',[[hylo,mapExpr,evalExpr,nTimes],'True'],depth(8))
                      -->(68,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(69,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(70,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(71,'&self',[nTimes,'True'],depth(11))
                          -->(72,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(73,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(74,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(75,'&self',[nTimes,'True'],depth(13))
                              -->(76,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(77,'&self',[nTimes,'True'],depth(13))
                  -->(78,'&self',['Plus',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]]],depth(7))
                      -->(79,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(9))
                      -->(80,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(81,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(82,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(83,'&self',[nTimes,'True'],depth(11))
                          -->(84,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(85,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(86,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(87,'&self',[nTimes,'True'],depth(13))
                              -->(88,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(89,'&self',[nTimes,'True'],depth(13))
                      -->(90,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],depth(9))
                          -->(91,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(92,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(11))
                          -->(93,'&self',[nTimes,'True'],depth(11))
                          -->(94,'&self',[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']],depth(11))
                              -->(95,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(96,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(97,'&self',[nTimes,'True'],depth(13))
                              -->(98,'&self',[hylo,mapExpr,evalExpr,nTimes],depth(13))
                              -->(99,'&self',[nTimes,'True'],depth(13))
                      -->(100,'&self',[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],depth(9))
Switched off tracing. For a longer trace !(pragma! tracelen 101))<span class="ansi33">
  (+ 
    (evalExpr 
      (mapExpr 
        (hylo mapExpr evalExpr nTimes) 
        (nTimes True))) 
    (evalExpr 
      (mapExpr 
        (hylo mapExpr evalExpr nTimes) 
        (nTimes True))))

</span><span class="ansi31">
! (assertEqualToResult 
    ( (hylo mapExpr evalExpr nTimes) 
      (and 3 
        (S 
          (S 
            (S Z))))) 
    ( (diff 
        (mapExpr 
          (para_pair mapExpr diff) 
          (unFix 
            (Fix 
              (Plus 
                (Fix 
                  (Var X)) 
                (Fix 
                  (Const 1)))))))))
(@ ! 
  (assertEqual 
    ( (+ 
        (evalExpr 
          (mapExpr 
            (hylo mapExpr evalExpr nTimes) 
            (nTimes True))) 
        (evalExpr 
          (mapExpr 
            (hylo mapExpr evalExpr nTimes) 
            (nTimes True))))) 
    ( (diff 
        (mapExpr 
          (para_pair mapExpr diff) 
          (unFix 
            (Fix 
              (Plus 
                (Fix 
                  (Var X)) 
                (Fix 
                  (Const 1))))))))))
write_pass_fail_result("EXAMPLES.EXPRESSION.105",exec,[[hylo,mapExpr,evalExpr,nTimes],[',',3,['S',['S',['S','Z']]]]],'FAIL',[[diff,[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',1]]]]]]]],[[+,[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]],[evalExpr,[mapExpr,[hylo,mapExpr,evalExpr,nTimes],[nTimes,'True']]]]])

</span>

--------------------------------------------------------------------------
; How to evaluate the structure, with access to the original expression (on top of the processed value)
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[diff,['Const',_]],['Fix',['Const',0]])
</span><span class="ansi38-255165000">  (= 
    (diff 
      (Const $_)) 
    (Fix 
      (Const 0)))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[diff,['Var',_]],['Fix',['Const',1]])
</span><span class="ansi38-255165000">  (= 
    (diff 
      (Var $_)) 
    (Fix 
      (Const 1)))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[diff,['Plus',[',',Dx,X],[',',Dy,Y]]],['Fix',['Plus',Dx,Dy]])
</span><span class="ansi38-255165000">  (= 
    (diff 
      (Plus 
        (and $Dx $X) 
        (and $Dy $Y))) 
    (Fix 
      (Plus $Dx $Dy)))
</span>

; (= (diff (Times (, $dx $x) (, $dy $y))) (Fix (Plus (Fix (Times $dx $y)) (Fix (Times $dy $x)))))
<span class="ansi38-000068000">!((para mapExpr diff) 
  (Fix 
    (Plus 
      (Fix 
        (Var X)) 
      (Fix 
        (Const 1)))))

</span>      -->(0,'&self',[[para,mapExpr,diff],['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',1]]]]],depth(1))
          -->(1,'&self',['Var','X'],depth(3))
        -->(2,'&self',[diff,[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',1]]]]]]],depth(2))
            -->(3,'&self',[para_pair,mapExpr,diff],depth(4))
            -->(4,'&self',[para_pair,mapExpr,diff],depth(4))
            -->(5,'&self',['Var','X'],depth(4))
            -->(6,'&self',['Const',1],depth(4))
            -->(7,'&self',[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',1]]]]]],depth(4))
                -->(8,'&self',[para_pair,mapExpr,diff],depth(6))
                -->(9,'&self',[para_pair,mapExpr,diff],depth(6))
                -->(10,'&self',['Var','X'],depth(6))
                -->(11,'&self',['Const',1],depth(6))
                -->(12,'&self',[para_pair,mapExpr,diff],depth(6))
                -->(13,'&self',[unFix,['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',1]]]]],depth(6))
                    -->(14,'&self',['Var','X'],depth(8))
                  -->(15,'&self',['Plus',['Fix',['Var','X']],['Fix',['Const',1]]],depth(7))
                      -->(16,'&self',['Var','X'],depth(9))
                      -->(17,'&self',['Fix',['Var','X']],depth(9))
                          -->(18,'&self',['Var','X'],depth(11))
                          -->(19,'&self',['Var','X'],depth(11))
                          -->(20,'&self',['Var','X'],depth(11))
                      -->(21,'&self',['Fix',['Const',1]],depth(9))
                          -->(22,'&self',['Const',1],depth(11))
                          -->(23,'&self',['Const',1],depth(11))
                          -->(24,'&self',['Const',1],depth(11))
                      -->(25,'&self',['Fix',['Var','X']],depth(9))
                          -->(26,'&self',['Var','X'],depth(11))
                          -->(27,'&self',['Var','X'],depth(11))
                          -->(28,'&self',['Var','X'],depth(11))
                      -->(29,'&self',['Fix',['Const',1]],depth(9))
                          -->(30,'&self',['Const',1],depth(11))
                          -->(31,'&self',['Const',1],depth(11))
                          -->(32,'&self',['Const',1],depth(11))
              -->(33,'&self',[mapExpr,[para_pair,mapExpr,diff],['Plus',['Fix',['Var','X']],['Fix',['Const',1]]]],depth(5))
                  -->(34,'&self',[para_pair,mapExpr,diff],depth(7))
                -->(35,'&self',['Plus',[[para_pair,mapExpr,diff],['Fix',['Var','X']]],[[para_pair,mapExpr,diff],['Fix',['Const',1]]]],depth(6))
                    -->(36,'&self',[para_pair,mapExpr,diff],depth(8))
                    -->(37,'&self',[[para_pair,mapExpr,diff],['Fix',['Var','X']]],depth(8))
                        -->(38,'&self',['Var','X'],depth(10))
                      -->(39,'&self',[',',[[para,mapExpr,diff],['Fix',['Var','X']]],['Fix',['Var','X']]],depth(9))
                          -->(40,'&self',[[para,mapExpr,diff],['Fix',['Var','X']]],depth(11))
                              -->(41,'&self',['Var','X'],depth(13))
                            -->(42,'&self',[diff,[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Var','X']]]]],depth(12))
                                -->(43,'&self',[para_pair,mapExpr,diff],depth(14))
                                -->(44,'&self',[para_pair,mapExpr,diff],depth(14))
                                -->(45,'&self',['Var','X'],depth(14))
                                -->(46,'&self',[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Var','X']]]],depth(14))
                                    -->(47,'&self',[para_pair,mapExpr,diff],depth(16))
                                    -->(48,'&self',[para_pair,mapExpr,diff],depth(16))
                                    -->(49,'&self',['Var','X'],depth(16))
                                    -->(50,'&self',[para_pair,mapExpr,diff],depth(16))
                                    -->(51,'&self',[unFix,['Fix',['Var','X']]],depth(16))
                                        -->(52,'&self',['Var','X'],depth(18))
                                      -->(53,'&self',['Var','X'],depth(17))
                                  -->(54,'&self',[mapExpr,[para_pair,mapExpr,diff],['Var','X']],depth(15))
                                      -->(55,'&self',[para_pair,mapExpr,diff],depth(17))
                                    -->(56,'&self',['Var','X'],depth(16))
                              -->(57,'&self',[diff,['Var','X']],depth(13))
                                  -->(58,'&self',['Var','X'],depth(15))
                                -->(59,'&self',['Fix',['Const',1]],depth(14))
                                    -->(60,'&self',['Const',1],depth(16))
                                    -->(61,'&self',['Const',1],depth(16))
                                    -->(62,'&self',['Const',1],depth(16))
                          -->(63,'&self',['Fix',['Var','X']],depth(11))
                              -->(64,'&self',['Var','X'],depth(13))
                              -->(65,'&self',['Var','X'],depth(13))
                              -->(66,'&self',['Var','X'],depth(13))
                    -->(67,'&self',[[para_pair,mapExpr,diff],['Fix',['Const',1]]],depth(8))
                        -->(68,'&self',['Const',1],depth(10))
                      -->(69,'&self',[',',[[para,mapExpr,diff],['Fix',['Const',1]]],['Fix',['Const',1]]],depth(9))
                          -->(70,'&self',[[para,mapExpr,diff],['Fix',['Const',1]]],depth(11))
                              -->(71,'&self',['Const',1],depth(13))
                            -->(72,'&self',[diff,[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Const',1]]]]],depth(12))
                                -->(73,'&self',[para_pair,mapExpr,diff],depth(14))
                                -->(74,'&self',[para_pair,mapExpr,diff],depth(14))
                                -->(75,'&self',['Const',1],depth(14))
                                -->(76,'&self',[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Const',1]]]],depth(14))
                                    -->(77,'&self',[para_pair,mapExpr,diff],depth(16))
                                    -->(78,'&self',[para_pair,mapExpr,diff],depth(16))
                                    -->(79,'&self',['Const',1],depth(16))
                                    -->(80,'&self',[para_pair,mapExpr,diff],depth(16))
                                    -->(81,'&self',[unFix,['Fix',['Const',1]]],depth(16))
                                        -->(82,'&self',['Const',1],depth(18))
                                      -->(83,'&self',['Const',1],depth(17))
                                  -->(84,'&self',[mapExpr,[para_pair,mapExpr,diff],['Const',1]],depth(15))
                                      -->(85,'&self',[para_pair,mapExpr,diff],depth(17))
                                    -->(86,'&self',['Const',1],depth(16))
                              -->(87,'&self',[diff,['Const',1]],depth(13))
                                  -->(88,'&self',['Const',1],depth(15))
                                -->(89,'&self',['Fix',['Const',0]],depth(14))
                                    -->(90,'&self',['Const',0],depth(16))
                                    -->(91,'&self',['Const',0],depth(16))
                                    -->(92,'&self',['Const',0],depth(16))
                          -->(93,'&self',['Fix',['Const',1]],depth(11))
                              -->(94,'&self',['Const',1],depth(13))
                              -->(95,'&self',['Const',1],depth(13))
                              -->(96,'&self',['Const',1],depth(13))
                              <--(87,retval(['Fix',['Const',0]]))
                                  <--(84,retval(['Const',1]))
                                    <--(81,retval(['Const',1]))
                                <--(76,retval([mapExpr,[para_pair,mapExpr,diff],['Const',1]]))
                            <--(72,retval([diff,['Const',1]]))
                          <--(70,retval([diff,[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Const',1]]]]]))
                      <--(69,retval('True'))
                    <--(67,retval([',',[[para,mapExpr,diff],['Fix',['Const',1]]],['Fix',['Const',1]]]))
                              <--(57,retval(['Fix',['Const',1]]))
                                  <--(54,retval(['Var','X']))
                                    <--(51,retval(['Var','X']))
                                <--(46,retval([mapExpr,[para_pair,mapExpr,diff],['Var','X']]))
                            <--(42,retval([diff,['Var','X']]))
                          <--(40,retval([diff,[mapExpr,[para_pair,mapExpr,diff],[unFix,['Fix',['Var','X']]]]]))
                      <--(39,retval('True'))
                    <--(37,retval([',',[[para,mapExpr,diff],['Fix',['Var','X']]],['Fix',['Var','X']]]))
                    -->(97,'&self',[[para_pair,mapExpr,diff],['Fix',['Var','X']]],depth(8))
                        -->(98,'&self',['Var','X'],depth(10))
                      -->(99,'&self',[',',[[para,mapExpr,diff],['Fix',['Var','X']]],['Fix',['Var','X']]],depth(9))
                          -->(100,'&self',[[para,mapExpr,diff],['Fix',['Var','X']]],depth(11))
Switched off tracing. For a longer trace !(pragma! tracelen 101))<span class="ansi33">
  (diff 
    (Plus True True))

</span><span class="ansi31">
! (assertEqualToResult 
    ( (para mapExpr diff) 
      (Fix 
        (Plus 
          (Fix 
            (Var X)) 
          (Fix 
            (Const 1))))) 
    ( (Fix $Y) 
      (2 t $X_C35_534) 
      (1 p $X_C35_535)))
(@ ! 
  (assertEqual 
    ( (diff 
        (Plus True True))) 
    ( (Fix $Y) 
      (2 t $X_C35_534) 
      (1 p $X_C35_535))))
write_pass_fail_result("EXAMPLES.EXPRESSION.106",exec,[[para,mapExpr,diff],['Fix',['Plus',['Fix',['Var','X']],['Fix',['Const',1]]]]],'FAIL',[['Fix',Y],[2,t,X_C35_534],[1,p,X_C35_535]],[[diff,['Plus','True','True']]])

</span>

--------------------------------------------------------------------------
; Unfold shorthand definitions like "1p" for "1 + X" into a Bind-Pure tree of expressions
<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[expand,[1,p,X]],['Plus',['Bind',['Const',1]],['Pure',X]])
</span><span class="ansi38-255165000">  (= 
    (expand 
      (1 p $X)) 
    (Plus 
      (Bind 
        (Const 1)) 
      (Pure $X)))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[expand,[2,t,X]],['Plus',['Pure',X],['Pure',X]])
</span><span class="ansi38-255165000">  (= 
    (expand 
      (2 t $X)) 
    (Plus 
      (Pure $X) 
      (Pure $X)))
</span>

<span class="ansi38-255165000"></span><span class="ansi38-015015015">  ; Action: load=metta_defn('&self',[expand,['Fix',X]],X)
</span><span class="ansi38-255165000">  (= 
    (expand 
      (Fix $X)) $X)
</span>

; Everything this can process
<span class="ansi38-000068000">!(match &self 
  (= 
    (expand $X) $Y) $X)

</span>      -->(0,'&self',[match,'&self',[=,[expand,_6090],_6108],_6090],depth(1))
        -->(1,'&self',[1,p,_7568],depth(2))
<span class="ansi33">  (1 p $_7568)
</span><span class="ansi32">['Y'=['Plus',['Bind',['Const',1]],['Pure',_7568]],'X'=[1,p,_7568]]
</span>

        -->(2,'&self',[2,t,_10210],depth(2))
<span class="ansi33">  (2 t $_10210)
</span><span class="ansi32">['Y'=['Plus',['Pure',_10210],['Pure',_10210]],'X'=[2,t,_10210]]
</span>

      <--(0,retval(['Fix',_12972]))
        -->(3,'&self',['Fix',_6108],depth(2))
<span class="ansi33">  (Fix $_6108)
</span><span class="ansi32">['Y'=_6108,'X'=['Fix',_6108]]
</span>

<span class="ansi31">
! (assertEqualToResult 
    (match &self 
      (= 
        (expand $X) $Y) $X) 
    ( (Fix 
        (Plus 
          (Fix 
            (Plus 
              (Fix 
                (Const 1)) 
              (Fix 
                (Var X)))) 
          (Fix 
            (Plus 
              (Fix 
                (Const 1)) 
              (Fix 
                (Var X))))))))
(@ ! 
  (assertEqual 
    ( (1 p $_15672) 
      (2 t $_15648) 
      (Fix $_15624)) 
    ( (Fix 
        (Plus 
          (Fix 
            (Plus 
              (Fix 
                (Const 1)) 
              (Fix 
                (Var X)))) 
          (Fix 
            (Plus 
              (Fix 
                (Const 1)) 
              (Fix 
                (Var X)))))))))
write_pass_fail_result("EXAMPLES.EXPRESSION.107",exec,[match,'&self',[=,[expand,X],Y],X],'FAIL',[['Fix',['Plus',['Fix',['Plus',['Fix',['Const',1]],['Fix',['Var','X']]]],['Fix',['Plus',['Fix',['Const',1]],['Fix',['Var','X']]]]]]],[[1,p,_15672],[2,t,_15648],['Fix',_15624]])

</span>

--------------------------------------------------------------------------
; Expand the definition
<span class="ansi38-000068000">!((futu mapExpr expand) 
  (2 t 
    (1 p 
      (Fix 
        (Var X)))))

</span>      -->(4,'&self',[[futu,mapExpr,expand],[2,t,[1,p,['Fix',['Var','X']]]]],depth(1))
          -->(5,'&self',['Var','X'],depth(3))
        -->(6,'&self',['Fix',[mapExpr,[futu_picking,mapExpr,expand],[expand,[2,t,[1,p,['Fix',['Var','X']]]]]]],depth(2))
            -->(7,'&self',[futu_picking,mapExpr,expand],depth(4))
            -->(8,'&self',[mapExpr,[futu_picking,mapExpr,expand],[expand,[2,t,[1,p,['Fix',['Var','X']]]]]],depth(4))
                -->(9,'&self',[futu_picking,mapExpr,expand],depth(6))
                -->(10,'&self',[futu_picking,mapExpr,expand],depth(6))
                -->(11,'&self',['Var','X'],depth(6))
                -->(12,'&self',[futu_picking,mapExpr,expand],depth(6))
                -->(13,'&self',[expand,[2,t,[1,p,['Fix',['Var','X']]]]],depth(6))
                    -->(14,'&self',['Var','X'],depth(8))
                  -->(15,'&self',['Plus',['Pure',[1,p,['Fix',['Var','X']]]],['Pure',[1,p,['Fix',['Var','X']]]]],depth(7))
                      -->(16,'&self',['Var','X'],depth(9))
                      -->(17,'&self',['Pure',[1,p,['Fix',['Var','X']]]],depth(9))
                          -->(18,'&self',['Var','X'],depth(11))
                          -->(19,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(20,'&self',['Var','X'],depth(13))
                              -->(21,'&self',['Fix',['Var','X']],depth(13))
                                  -->(22,'&self',['Var','X'],depth(15))
                                  -->(23,'&self',['Var','X'],depth(15))
                                  -->(24,'&self',['Var','X'],depth(15))
                          -->(25,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(26,'&self',['Var','X'],depth(13))
                              -->(27,'&self',['Fix',['Var','X']],depth(13))
                                  -->(28,'&self',['Var','X'],depth(15))
                                  -->(29,'&self',['Var','X'],depth(15))
                                  -->(30,'&self',['Var','X'],depth(15))
                      -->(31,'&self',['Pure',[1,p,['Fix',['Var','X']]]],depth(9))
                          -->(32,'&self',['Var','X'],depth(11))
                          -->(33,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(34,'&self',['Var','X'],depth(13))
                              -->(35,'&self',['Fix',['Var','X']],depth(13))
                                  -->(36,'&self',['Var','X'],depth(15))
                                  -->(37,'&self',['Var','X'],depth(15))
                                  -->(38,'&self',['Var','X'],depth(15))
                          -->(39,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(40,'&self',['Var','X'],depth(13))
                              -->(41,'&self',['Fix',['Var','X']],depth(13))
                                  -->(42,'&self',['Var','X'],depth(15))
                                  -->(43,'&self',['Var','X'],depth(15))
                                  -->(44,'&self',['Var','X'],depth(15))
                      -->(45,'&self',['Pure',[1,p,['Fix',['Var','X']]]],depth(9))
                          -->(46,'&self',['Var','X'],depth(11))
                          -->(47,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(48,'&self',['Var','X'],depth(13))
                              -->(49,'&self',['Fix',['Var','X']],depth(13))
                                  -->(50,'&self',['Var','X'],depth(15))
                                  -->(51,'&self',['Var','X'],depth(15))
                                  -->(52,'&self',['Var','X'],depth(15))
                          -->(53,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(54,'&self',['Var','X'],depth(13))
                              -->(55,'&self',['Fix',['Var','X']],depth(13))
                                  -->(56,'&self',['Var','X'],depth(15))
                                  -->(57,'&self',['Var','X'],depth(15))
                                  -->(58,'&self',['Var','X'],depth(15))
                      -->(59,'&self',['Pure',[1,p,['Fix',['Var','X']]]],depth(9))
                          -->(60,'&self',['Var','X'],depth(11))
                          -->(61,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(62,'&self',['Var','X'],depth(13))
                              -->(63,'&self',['Fix',['Var','X']],depth(13))
                                  -->(64,'&self',['Var','X'],depth(15))
                                  -->(65,'&self',['Var','X'],depth(15))
                                  -->(66,'&self',['Var','X'],depth(15))
                          -->(67,'&self',[1,p,['Fix',['Var','X']]],depth(11))
                              -->(68,'&self',['Var','X'],depth(13))
                              -->(69,'&self',['Fix',['Var','X']],depth(13))
                                  -->(70,'&self',['Var','X'],depth(15))
                                  -->(71,'&self',['Var','X'],depth(15))
                                  -->(72,'&self',['Var','X'],depth(15))
              -->(73,'&self',[mapExpr,[futu_picking,mapExpr,expand],['Plus',['Pure',[1,p,['Fix',['Var','X']]]],['Pure',[1,p,['Fix',['Var','X']]]]]],depth(5))
                  -->(74,'&self',[futu_picking,mapExpr,expand],depth(7))
                -->(75,'&self',['Plus',[[futu_picking,mapExpr,expand],['Pure',[1,p,['Fix',['Var','X']]]]],[[futu_picking,mapExpr,expand],['Pure',[1,p,['Fix',['Var','X']]]]]],depth(6))
                    -->(76,'&self',[futu_picking,mapExpr,expand],depth(8))
                    -->(77,'&self',[[futu_picking,mapExpr,expand],['Pure',[1,p,['Fix',['Var','X']]]]],depth(8))
                        -->(78,'&self',['Var','X'],depth(10))
                      -->(79,'&self',[[futu,mapExpr,expand],[1,p,['Fix',['Var','X']]]],depth(9))
                          -->(80,'&self',['Var','X'],depth(11))
                        -->(81,'&self',['Fix',[mapExpr,[futu_picking,mapExpr,expand],[expand,[1,p,['Fix',['Var','X']]]]]],depth(10))
                            -->(82,'&self',[futu_picking,mapExpr,expand],depth(12))
                            -->(83,'&self',[mapExpr,[futu_picking,mapExpr,expand],[expand,[1,p,['Fix',['Var','X']]]]],depth(12))
                                -->(84,'&self',[futu_picking,mapExpr,expand],depth(14))
                                -->(85,'&self',[futu_picking,mapExpr,expand],depth(14))
                                -->(86,'&self',['Var','X'],depth(14))
                                -->(87,'&self',[futu_picking,mapExpr,expand],depth(14))
                                -->(88,'&self',[expand,[1,p,['Fix',['Var','X']]]],depth(14))
                                    -->(89,'&self',['Var','X'],depth(16))
                                  -->(90,'&self',['Plus',['Bind',['Const',1]],['Pure',['Fix',['Var','X']]]],depth(15))
                                      -->(91,'&self',['Const',1],depth(17))
                                      -->(92,'&self',['Bind',['Const',1]],depth(17))
                                          -->(93,'&self',['Const',1],depth(19))
                                          -->(94,'&self',['Const',1],depth(19))
                                          -->(95,'&self',['Const',1],depth(19))
                                      -->(96,'&self',['Pure',['Fix',['Var','X']]],depth(17))
                                          -->(97,'&self',['Var','X'],depth(19))
                                          -->(98,'&self',['Fix',['Var','X']],depth(19))
                                              -->(99,'&self',['Var','X'],depth(21))
                                              -->(100,'&self',['Var','X'],depth(21))
Switched off tracing. For a longer trace !(pragma! tracelen 101))<span class="ansi33">
  (Fix 
    (Plus 
      (Fix 
        (Plus 
          ( (futu_picking mapExpr expand) 
            (Bind 
              (Const 1))) 
          (Fix 
            (Var X)))) 
      (Fix 
        (Plus 
          ( (futu_picking mapExpr expand) 
            (Bind 
              (Const 1))) 
          (Fix 
            (Var X))))))

</span><span class="ansi32">% 2,291,896 inferences, 0.673 CPU in 0.673 seconds (100% CPU, 3407355 Lips)
</span> (@ = "/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.metta" 0)
<span class="ansi1">LoonIt Report
</span>------------
<span class="ansi32">Successes: 0
</span><span class="ansi31">Failures: 5
</span>doing(ansi2html -u < "/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/TEE.ansi" > "/opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/vspace-metta/examples/compat/metta-examples/recursion-schemes/src/examples/expression.html" )

</pre>
</body>

</html>
